\begin{frame}
  \titlepage
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \singletitle{Introduction}
  \notelist{
  \item TODO
  }
\end{frame}

\begin{frame}
  \frametitle{Goals}
  \begin{itemize}
    \item A safe HTTP middleware architecture
    \item Make the effects of applying middleware explicit in types
    \item Ensure correct composition of middleware and application components
    \item Interoperability with NodeJS and other backends (purerl, purescript-native)
    \item No magic
  \end{itemize}
  \notelist{
  \item TODO
  }
\end{frame}

\begin{frame}
  \frametitle{We do not want...}
  \begin{itemize}
    \item Incorrect ordering header and body writing
    \item Writing incomplete, or multiple, responses
    \item Consuming of a non-parsed request body
    \item Consuming of a request body parsed as the wrong type
    \item Missing error handling middleware
    \item Missing authentication and/or authorization checks
    \item Linking, in an HTML anchor, to a resource that is not routed
    \item Posting, in an HTML form, to a resource that is not routed
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{How}
  \begin{itemize}
    \item Track middleware effects in type system (not only side-effects!)
    \item Leverage extensible records in PureScript
    \item Provide a common API for middleware
    \item Write backend-agnostic middleware where possible
    \item Integrate with existing NodeJS middleware
  \end{itemize}
\end{frame}

\begin{frame}
  \singletitle{Design}
  \notelist{
  \item TODO
  }
\end{frame}

\begin{frame}
  \frametitle{Conn}
  \lstinputlisting[language=purescript]{src/listings/Conn.purs}
  \notelist{
  \item Conn, short for Connection
  \item Models the entirety of an HTTP connection
  \item Design adapted from Plug in Elixir
    }
\end{frame}


\begin{frame}
  \frametitle{Middleware}
  \lstinputlisting[language=purescript]{src/listings/Middleware.purs}
  \notelist{
  \item A function transforming a Conn to another Conn, in some monadic type \textit{m}
  \item A type synonym, but still a regular function
  \item The \textit{m} can be any monad stack
  \item Can be used to maintain state, record metrics, provide configuration
    }
\end{frame}

\begin{frame}
  \frametitle{Response State Transitions}
  \begin{itemize}
    \item Hyper tracks the state of response writing
    \item \textit{conn.response.writer}
    \item Parameterized by a state type parameter to ensure correctness in ordering
    \item Constrained by the \textit{ResponseWriter} type class
    \item Response-writing middleware can be backend-agnostic
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{ResponseStateTransition}
  \lstinputlisting[language=purescript,style=medium-size]{src/listings/ResponseStateTransition.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}[fragile]
  \frametitle{ResponseWriter}
  \lstinputlisting[language=purescript,style=small-size]{src/listings/ResponseWriter.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Writing Headers}
  \lstinputlisting[language=purescript,style=medium-size]{src/listings/headers.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Writing a Response}
  \lstinputlisting[language=purescript]{src/listings/Response.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Writing a Response}
  \lstinputlisting[language=purescript,style=medium-size,firstline=1,lastline=8]{src/listings/respond.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Writing a Response}
  \lstinputlisting[language=purescript,firstline=9]{src/listings/respond.purs}
  \notelist{
  \item The implementation is quite simple.
    }
\end{frame}

\begin{frame}
  \frametitle{Parsing the Request Body}
  \lstinputlisting[language=purescript,style=small-size]{src/listings/readBodyAsString.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Parsing the Request Body}
  \lstinputlisting[language=purescript,style=small-size]{src/listings/readBody.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \singletitle{Form Parsing}
  \notelist{
  \item TODO
  }
\end{frame}

\begin{frame}
  \frametitle{Form Parsing}
  \lstinputlisting[language=purescript,firstline=1,lastline=15,style=medium-size]{src/listings/parseForm.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Form Parsing}
  \lstinputlisting[language=purescript,firstline=16,style=smaller-size]{src/listings/parseForm.purs}
  \notelist{
  \item Hej hopp
    }
\end{frame}

\begin{frame}
  \singletitle{Example (Form Parsing)}
  \notelist{
  \item TODO
  }
\end{frame}

\begin{frame}
  \frametitle{Example (Form Parsing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-renderNameForm.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Example (Form Parsing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-htmlWithStatus.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Example (Form Parsing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-form-handler.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Example (Form Parsing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-form-handlePost.purs}
  \notelist{
  \item TODO
    }
\end{frame}


\begin{frame}
  \frametitle{Example (Form Parsing)}
  \lstinputlisting[language=purescript,style=small-size]{src/listings/example-form-app.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \singletitle{Demo}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \singletitle{Example (Type-Safe Routing)}
  \notelist{
  \item TODO
  }
\end{frame}

\begin{frame}
  \frametitle{Example (Type-Safe Routing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-routing-about.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Example (Type-Safe Routing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-routing-home.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Example (Type-Safe Routing)}
  \lstinputlisting[language=purescript,style=smaller-size]{src/listings/example-routing-app.purs}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \singletitle{Demo}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \singletitle{Next Up}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \frametitle{Next Up}
  \begin{itemize}
    \item Routed resources should be encoded in Conn types
    \item Cross-routing is tricky, requires annotations
    \item All the WEB SCALE stuff
  \end{itemize}
\end{frame}

\begin{frame}
  \singletitle{Thank You}
  \notelist{
  \item TODO
    }
\end{frame}

\begin{frame}
  \titlepage
  \notelist{
  \item TODO
    }
\end{frame}

